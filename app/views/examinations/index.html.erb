<%= content_for :title do %>
  <%= t "page.front-end.examination.index.title" %>
<% end %>

<%= content_for :page_title do %>
  <%= t "page.front-end.examination.index.title" %>
<% end %>

<%= form_for(@exam) do |f| %>
  <div class="row">
    <div class="input-field col s12">
      <div class="collect">
        <%= f.select(:subject_id) do %>
          <% @subjects.collect do |c| %>
            <%= content_tag(:option, c.name, value: c.id) %>
          <% end %>
        <% end %>
        <%= f.label :subject %><br>
        <%= f.hidden_field :status, value: :start %>
        <%= f.hidden_field :user_id, value: current_user.id %>
      </div>
      <%= submit_tag t("page.views.devise.examination.view.index.create"),
        class: "btn btn-md btn-primary pink" %>
    </div>
  </div>
<% end %>
<div class="row">
  <table class="striped centered highlight" id="table-examinations">
    <thead>
      <tr>
        <th data-field="stt">
          <%= t "page.views.devise.examination.view.index.stt" %>
        </th>
        <th data-field="subject">
          <%= t "page.views.devise.examination.view.index.subject" %>
        </th>
        <th data-field="status">
          <%= t "page.views.devise.examination.view.index.status" %>
        </th>
        <th data-field="duration">
          <%= t "page.views.devise.examination.view.index.duration" %>
        </th>
        <th data-field="question_number">
          <%= t "page.views.devise.examination.view.index.question_number" %>
        </th>
        <th data-field="spent_time">
          <%= t "page.views.devise.examination.view.index.spent_time" %>
        </th>
        <th data-field="score">
          <%= t "page.views.devise.examination.view.index.score" %>
        </th>
        <th data-field="action" class="center-align">
          <%= t "page.admin.action.action" %>
        </th>
      </tr>
    </thead>
    <tbody>
      <% @examinations.each_with_index do |examination, index| %>
        <tr>
          <td><%= index+1 %></td>
          <td><%= examination.subject_name %></td>
          <td>
            <% if examination.status == "uncheck" %>
              <label class="label-status label-danger">
            <% elsif examination.status == "checked" %>
              <label class="label-status label-success">
            <% elsif examination.status == "start" %>
              <label class="label-status label-primary">
            <% else %>
              <label class="label-status label-warning">
            <% end %>
              <%= examination.status %>
            </label>
          </td>
          <td><%= examination.subject_duration %></td>
          <td><%= examination.subject_question_number %></td>
          <td><%= spend_time examination %></td>
          <td>
            <% if examination.checked? %>
              <%= examination.results.is_corrects.count %>/
              <%= examination.subject.question_number %>
            <% else %>
              ---
            <% end %>
          </td>
          <td>
            <% if examination.start? %>
              <%= link_to t("page.admin.exams.start"),
                examination_path(examination),
                class: "waves-effect waves-light btn blue" %>
            <% else %>
              <%= link_to t("page.admin.exams.view"),
                examination_path(examination),
                class: "waves-effect waves-light btn green" %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  <%= paginate @examinations %>
</div>
